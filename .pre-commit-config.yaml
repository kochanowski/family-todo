repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: check-yaml
      - id: check-merge-conflict
      - id: check-case-conflict
      - id: check-added-large-files
        args: ["--maxkb=500"]
      - id: end-of-file-fixer
      - id: trailing-whitespace
  - repo: local
    hooks:
      - id: swiftlint
        name: swiftlint
        entry: scripts/run-swiftlint.sh
        language: system
        files: \.swift$
      - id: swiftformat
        name: swiftformat
        entry: swiftformat
        language: system
        files: \.swift$
      - id: xcodebuild-tests
        name: xcodebuild tests
        entry: bash -c 'if command -v xcodebuild >/dev/null; then SIMULATOR_ID=$(xcrun simctl list devices available --json | jq -r ".devices | to_entries | map(select(.key | contains(\"iOS\"))) | .[0].value | .[0].udid" 2>/dev/null); if [ -n "$SIMULATOR_ID" ]; then xcodebuild test -project FamilyTodo.xcodeproj -scheme HousePulse -destination "platform=iOS Simulator,id=${SIMULATOR_ID}" CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED=NO CODE_SIGNING_ALLOWED=NO; else echo "No iOS simulator available, skipping tests"; fi; else echo "xcodebuild not available, skipping tests"; fi'
        language: system
        pass_filenames: false
